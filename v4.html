<!DOCTYPE html>
<html>
<head>
<title>Чпокер - пупырчатый релаксант v4</title>
<meta name="title" content="Чпокер - пупырчатый релаксант" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style type="text/css">
  html, body {
    width:  100vw;
    height: 100vh;
    margin: 0;
    padding:0;
    font-family: Verdana, sans-serif;
    display: block;
    overflow: hidden;
  }
  canvas { 
    width:  100vw;
    height: 100vh;
    background-color: #666;}
  
</style>
</head>
<body>


<canvas id="canvas"></canvas>

<script>
  const ctx = document.getElementById('canvas').getContext('2d');
  window.addEventListener('resize', function(e){
    ctx.canvas.width  = window.innerWidth;
    ctx.canvas.height = window.innerHeight;
  })
  ctx.canvas.width  = window.innerWidth;
  ctx.canvas.height = window.innerHeight;
  

  const sprite = {
    img: new Image,
    size: 44,  // size of the sprite
    new:[      // new elements
      { sx: 62, sy: 99 },
      { sx: 106, sy: 99 },
      { sx: 275, sy: 187 },
      { sx: 148, sy: 186 },
      { sx: 176, sy: 142 },
      { sx: 234, sy: 99 },
    ],
    chpocked:[ // chpocked elements
      { sx: 48, sy: 56 },
      { sx: 149, sy: 99 },
  ]};
  sprite.img.addEventListener('load', () => {
    console.log('Image loaded');
    const spritemax = sprite.new.length-1;
    for ( var y = 0; y < (ctx.canvas.height+100)/sprite.size; y++) {
    for ( var x = 0; x < (ctx.canvas.width+100)/sprite.size; x++) {
        let xr = (y%2 ? x-.5 : x)*sprite.size; 
        let yr =  y*sprite.size;
        let rnd = Math.floor(Math.random()*spritemax);
        let spr = sprite.new[rnd]
        ctx.drawImage(sprite.img, spr.sx, spr.sy, sprite.size, sprite.size, xr, yr, sprite.size, sprite.size);
      }
    }   
    console.log('Image drawn');
  });
  sprite.img.src = 'chpocker.jpg';


</script>
</body>
</html>
